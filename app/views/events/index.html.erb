<% if @pending_events.any? %>
  <h3><%= pluralize(@pending_events.count, 'invite') %></h3>

  <% @pending_events.each do |pending_event| %>
    <% date = pending_event.date.strftime '%A, %e %B' %>
    <p style="margin-bottom: 0">

      <%= link_to 'Reject',
        user_event_path(pending_event),
        method: :delete,
        data: { confirm: 'Are you sure?' },
        class: 'text-danger' %>

      <%= link_to 'Accept',
        user_event_path(pending_event),
        method: :patch,
        class: 'text-success' %>
      <br>
      <%= pending_event.name %> | <%= date %> | <%= pending_event.address %>
    </p>
    <p style="margin-top: 0">
      <small>
        <% pending_event.user_events.each do |friend| %>
          <%= friend.user.name || friend.user.email %> (<%= friend.status %>)
        <% end %>
      </small>
    </p>
  <% end %>
<% else %>
  <h3 style="text-align: center">No pending invitations!</h3>
<% end %>

<% if @admin_events.any? %>
  <h3>Your events</h3>

  <% @admin_events.each do |admin_event| %>
    <% date = admin_event.date.strftime '%A, %e %B' %>
    <p style="margin-bottom: 0">
      <% if admin_event.results.any? %>
        <%= link_to 'Results',
          event_results_path(admin_event),
          class: 'text-success' %>
      <% else %>
        <span class="text-secondary">no results</span>
      <% end %>

      <% if admin_event.everyone_swiped?(Movie.in_common(admin_event)) %>
        <span class="text-secondary">
          <%= (admin_event.date.to_date - Date.today.to_date).to_i %> days left
        </span>
      <% elsif admin_event.someone_new_accepted? %>
        <%= link_to 'Swipe', event_path(admin_event), class: 'text-warning' %>
      <% end %>

      <%= link_to 'Edit', edit_event_path(admin_event) %>
      <%= link_to 'Delete',
        event_path(admin_event),
        method: :delete,
        data: { confirm: 'Are you sure?' },
        class: 'text-danger' %>
      <br>
      <%= admin_event.name %> | <%= date %> | <%= admin_event.address %>
    </p>
    <p style="margin-top: 0">
      <small>
        <% admin_event.user_events.each do |friend| %>
          <%= friend.user.name || friend.user.email %> (<%= friend.status %>)
        <% end %>
      </small>
    </p>
  <% end %>
<% else %>
  <h3 style="text-align: center">No events! <small><%= link_to 'Create one?', new_event_path %></small></h3>
<% end %>

<% if @accepted_events.any? %>
  <h3>Accepted events</h3>

  <% @accepted_events.each do |accepted_event| %>
    <% date = accepted_event.date.strftime '%A, %e %B' %>
    <p style="margin-bottom: 0">
      <% if accepted_event.results.any? %>
        <%= link_to 'Results',
          event_results_path(accepted_event),
          class: 'text-success' %>
      <% else %>
        <span class="text-secondary">no results</span>
      <% end %>

      <% if accepted_event.everyone_swiped?(Movie.in_common(accepted_event)) %>
        <span class="text-secondary">
          <%= (accepted_event.date.to_date - Date.today.to_date).to_i %> days left
        </span>
      <% elsif accepted_event.someone_new_accepted? %>
        <%= link_to 'Swipe', event_path(accepted_event), class: 'text-warning' %>
      <% end %>

      <br>
      <%= accepted_event.name %> | <%= date %> | <%= accepted_event.address %>
    </p>
    <p style="margin-top: 0">
      <small>
        <% accepted_event.user_events.each do |friend| %>
          <%= friend.user.name || friend.user.email %> (<%= friend.status %>)
        <% end %>
      </small>
    </p>
  <% end %>
<% else %>
  <h3 style="text-align: center">No accepted events</h3>
<% end %>
